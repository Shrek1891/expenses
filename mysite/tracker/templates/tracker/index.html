{% extends 'tracker/base.html' %}
{% load humanize %}
{% block content %}
<div class="container">
    <form class="d-flex p-2 gap-2 flex-column justify-content-center align-items-center" method="post">
        {% csrf_token %}
        {{expense_form.as_p.name}}
        <div class="col  w-50">
            <input class="p-2 border border-gray-300 rounded-5 w-100" type="text" name="name"
                   placeholder="Expense Name" required id="name">
        </div>
        <div class="col w-50">
            <input class="p-2 border border-gray-300 rounded-5 w-100" id="amount" type="number" name="amount"
                   placeholder="Amount">
        </div>
        <div class="col w-50 d-flex justify-content-center align-items-center">
            <select name="category" id="category" class="border border-gray-300 rounded-5 p-2 w-50">
                <option value="Food">Food</option>
                <option value="Transport">Transport</option>
                <option value="Entertainment">Entertainment</option>
                <option value="Shopping">Shopping</option>
                <option value="Other">Other</option>
            </select>
        </div>
        <button type="submit" class="border  border-gray-300 rounded-2 p-2">Add</button>
    </form>
    <div class="">
        <table class="table" id="expenseTable">
            <thead>
            <tr>
                <th scope="col">Name</th>
                <th scope="col">Amount</th>
                <th scope="col">Category</th>
                <th scope="col">Date</th>
                <th scope="col">Edit</th>
                <th scope="col">Delete</th>
            </tr>
            </thead>
            <tbody>
            {% for expense in expenses %}
            <tr>
                <td>{{expense.name}}</td>
                <td>$ {{expense.amount|intcomma }}</td>
                <td>{{expense.category}}</td>
                <td>{{expense.date}}</td>
                <td><a href="{% url 'edit_expense' expense.id %}" class="btn-primary btn">Edit</a></td>
                <td><a href="{% url 'delete_expense' expense.id %}" class="btn btn-danger btn-small">Delete</a></td>
            </tr>
            {% endfor %}
            {% if total_expenses %}
            <tr>
                <td colspan="1"><h4>Total</h4></td>
                <td class="text-green">$ {{ total_expenses|intcomma }}</td>
            </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
</div>
<div class="container">
    <h2>Expenses</h2>
    <div class="d-flex justify-content-between align-items-center gap-8">
        <p class="border border-gray-300 rounded-5 p-2 w-100">Year: $ {{ expenses_last_year|intcomma }}</p>
        <p class="border border-gray-300 rounded-5 p-2 w-100">Month: $ {{ expenses_last_month|intcomma }}</p>
        <p class="border border-gray-300 rounded-5 p-2 w-100">Week: $ {{ expenses_last_week|intcomma }}</p>
    </div>
    <div class="border border-gray-300 rounded-5 p-2">
        <h4 class="border border-gray-300 rounded-5 p-2">Last 30 days</h4>
        {% for daily_sum in data %}
            <p class="border border-gray-300 rounded-5 p-2">{{daily_sum.date}}: $ {{daily_sum.amount__sum|intcomma}}</p>
        {% endfor %}
    </div>
    <div class="border border-gray-300 rounded-5 p-2">
        <h4 class="border border-gray-300 rounded-5 p-2">Categories</h4>
        {% for category in categories %}
            <p class="border border-gray-300 rounded-5 p-2">{{category.category}}: $ {{category.amount__sum|intcomma}}</p>
        {% endfor %}
    </div>
</div>


{% endblock %}